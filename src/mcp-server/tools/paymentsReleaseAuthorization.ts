/*
 * Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.
 */

import { paymentsReleaseAuthorization } from "../../funcs/paymentsReleaseAuthorization.js";
import * as operations from "../../models/operations/index.js";
import { formatResult, ToolDefinition } from "../tools.js";

const args = {
  request: operations.ReleaseAuthorizationRequest$inboundSchema,
};

export const tool$paymentsReleaseAuthorization: ToolDefinition<typeof args> = {
  name: "payments-release-authorization",
  description: `Release payment authorization

Releases the full remaining authorized amount. Call this endpoint when you will not be making any additional
captures. Payment authorizations may also be released manually from the Mollie Dashboard.

Mollie will do its best to process release requests, but it is not guaranteed that it will succeed. It is up to
the issuing bank if and when the hold will be released.

If the request does succeed, the payment status will change to \`canceled\` for payments without captures.
If there is a successful capture, the payment will transition to \`paid\`.`,
  args,
  tool: async (client, args, ctx) => {
    const [result, apiCall] = await paymentsReleaseAuthorization(
      client,
      args.request,
      { fetchOptions: { signal: ctx.signal } },
    ).$inspect();

    if (!result.ok) {
      return {
        content: [{ type: "text", text: result.error.message }],
        isError: true,
      };
    }

    const value = result.value;

    return formatResult(value, apiCall);
  },
};
